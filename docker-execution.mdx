---
title: "Docker Execution"
description: "Run any Docker container on Lyceum's cloud infrastructure with GPU support"
icon: "docker"
---

<Info>
  Execute any OCI-compatible Docker image on Lyceum Cloud. Bring your own containers with custom dependencies, ML frameworks, or specialized environments.
</Info>

## Overview

Docker execution allows you to run containerized workloads on Lyceum's infrastructure. Perfect for reproducible environments, custom dependencies, and production deployments.

<CardGroup cols={3}>
  <Card title="Any Registry" icon="box">
    Docker Hub, ECR, GCR, or private registries
  </Card>
  <Card title="GPU Support" icon="microchip">
    Automatic NVIDIA runtime for ML workloads
  </Card>
  <Card title="Real-time Output" icon="terminal">
    Stream logs and results as they happen
  </Card>
</CardGroup>

## Quick Start

<Tabs>
  <Tab title="Public Image" icon="globe">
    Run a public Docker Hub image:
    
    ```bash
    curl -X POST https://api.lyceum.technology/api/v2/external/execution/image/start \
      -H "Authorization: Bearer <TOKEN>" \
      -H "Content-Type: application/json" \
      -d '{
        "docker_image_ref": "python:3.11-slim",
        "docker_run_cmd": ["python", "-c", "print(\"Hello from Docker!\")"],
        "execution_type": "cpu"
      }'
    ```
  </Tab>

  <Tab title="Private Registry" icon="lock">
    Use images from private registries with authentication:
    
    ```bash
    curl -X POST https://api.lyceum.technology/api/v2/external/execution/image/start \
      -H "Authorization: Bearer <TOKEN>" \
      -H "Content-Type: application/json" \
      -d '{
        "docker_image_ref": "myregistry.com/myimage:latest",
        "docker_registry_credential_type": "basic",
        "docker_registry_credentials": {
          "username": "myuser",
          "password": "mypassword"
        },
        "execution_type": "cpu"
      }'
    ```
  </Tab>

  <Tab title="GPU Workload" icon="gpu-card">
    Run ML models with GPU acceleration:
    
    ```bash
    curl -X POST https://api.lyceum.technology/api/v2/external/execution/image/start \
      -H "Authorization: Bearer <TOKEN>" \
      -H "Content-Type: application/json" \
      -d '{
        "docker_image_ref": "pytorch/pytorch:2.6.0-cuda12.4-cudnn9-runtime",
        "docker_run_cmd": ["python", "train_model.py"],
        "execution_type": "gpu",
        "timeout": 3600
      }'
    ```
  </Tab>
</Tabs>

## Container Registries

<AccordionGroup>
  <Accordion title="Docker Hub" icon="docker">
    ### Public Images
    No authentication required for public images:
    ```json
    {
      "docker_image_ref": "nginx:latest"
    }
    ```
    
    ### Private Images
    Use Docker Hub credentials:
    ```json
    {
      "docker_image_ref": "myuser/private-image:tag",
      "docker_registry_credential_type": "basic",
      "docker_registry_credentials": {
        "username": "dockerhub-username",
        "password": "dockerhub-token"
      }
    }
    ```
  </Accordion>

  <Accordion title="AWS ECR" icon="aws">
    ### Configuration
    ```json
    {
      "docker_image_ref": "245706660333.dkr.ecr.eu-north-1.amazonaws.com/myapp:latest",
      "docker_registry_credential_type": "aws",
      "docker_registry_credentials": {
        "region": "eu-north-1",
        "aws_access_key_id": "AKIAIOSFODNN7EXAMPLE",
        "aws_secret_access_key": "wJalrXUtnFEMI/K7MDENG",
        "aws_session_token": "AQoDYXdzEPT//" // optional
      }
    }
    ```
    
    <Tip>
      ECR credentials are automatically refreshed if they expire during long-running executions
    </Tip>
  </Accordion>

  <Accordion title="Google Container Registry" icon="google">
    ### Using Service Account
    ```json
    {
      "docker_image_ref": "gcr.io/project-id/image:tag",
      "docker_registry_credential_type": "basic",
      "docker_registry_credentials": {
        "username": "_json_key",
        "password": "{\"type\": \"service_account\", ...}"
      }
    }
    ```
  </Accordion>

  <Accordion title="GitHub Container Registry" icon="github">
    ### Personal Access Token
    ```json
    {
      "docker_image_ref": "ghcr.io/username/image:tag",
      "docker_registry_credential_type": "basic",
      "docker_registry_credentials": {
        "username": "github-username",
        "password": "ghp_xxxxxxxxxxxxxxxxxxxx"
      }
    }
    ```
  </Accordion>
</AccordionGroup>

## API Reference

### Start Execution

**Endpoint:** `POST /api/v2/external/execution/image/start`

<CodeGroup>
  ```python Python
  import requests
  
  response = requests.post(
      "https://api.lyceum.technology/api/v2/external/execution/image/start",
      headers={"Authorization": f"Bearer {token}", "Content-Type": "application/json"},
      json={
          "docker_image_ref": "python:3.11",
          "docker_run_cmd": ["python", "script.py"],
          "docker_run_env": "PYTHONUNBUFFERED=1\nMY_VAR=value",
          "execution_type": "cpu",
          "timeout": 300
      }
  )
  
  execution_id = response.json()["execution_id"]
  print(f"Started execution: {execution_id}")
  ```

  ```javascript JavaScript
  const response = await fetch(
    'https://api.lyceum.technology/api/v2/external/execution/image/start',
    {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        docker_image_ref: 'node:20-alpine',
        docker_run_cmd: ['node', 'app.js'],
        docker_run_env: 'NODE_ENV=production',
        execution_type: 'cpu'
      })
    }
  );
  
  const { execution_id } = await response.json();
  console.log(`Started execution: ${execution_id}`);
  ```

  ```bash cURL
  curl -X POST https://api.lyceum.technology/api/v2/external/execution/image/start \
    -H "Authorization: Bearer <TOKEN>" \
    -H "Content-Type: application/json" \
    -d '{
      "docker_image_ref": "alpine:latest",
      "docker_run_cmd": ["echo", "Hello World"],
      "execution_type": "cpu"
    }'
  ```
</CodeGroup>

### Request Parameters

<ResponseField name="docker_image_ref" type="string" required>
  Fully qualified Docker image reference (e.g., `python:3.11`, `myregistry.com/image:tag`)
</ResponseField>

<ResponseField name="execution_type" type="string" default="cpu">
  Resource type: `cpu`, `gpu`, or `auto`
</ResponseField>

<ResponseField name="docker_run_cmd" type="array">
  Override container command (e.g., `["python", "script.py"]`)
</ResponseField>

<ResponseField name="docker_run_env" type="string">
  Environment variables as newline-separated KEY=VALUE pairs
</ResponseField>

<ResponseField name="timeout" type="integer" default="300">
  Maximum execution time in seconds
</ResponseField>

<ResponseField name="docker_registry_credential_type" type="string">
  Authentication type: `basic` or `aws`
</ResponseField>

<ResponseField name="docker_registry_credentials" type="object">
  Registry authentication credentials (see examples above)
</ResponseField>

## Environment Configuration

<Tabs>
  <Tab title="Environment Variables" icon="gear">
    Pass environment variables to your container:
    
    ```python
    env_vars = """
    PYTHONUNBUFFERED=1
    DATABASE_URL=postgresql://user:pass@host/db
    API_KEY=your-secret-key
    DEBUG=true
    """
    
    response = requests.post(
        url,
        json={
            "docker_image_ref": "myapp:latest",
            "docker_run_env": env_vars
        }
    )
    ```
  </Tab>

  <Tab title="Command Override" icon="terminal">
    Override the container's default command:
    
    ```python
    # Run a specific script
    {
        "docker_run_cmd": ["python", "train.py", "--epochs", "100"]
    }
    
    # Interactive Python
    {
        "docker_run_cmd": ["python", "-c", "import torch; print(torch.__version__)"]
    }
    
    # Shell commands
    {
        "docker_run_cmd": ["sh", "-c", "ls -la && python app.py"]
    }
    ```
  </Tab>

  <Tab title="Storage Access" icon="database">
    Access Lyceum storage from your container:
    
    ```python
    # Files are automatically mounted at /lyceum/storage
    {
        "docker_image_ref": "python:3.11",
        "docker_run_cmd": ["python", "-c", """
    import os
    
    # List storage files
    print(os.listdir('/lyceum/storage'))
    
    # Read data
    with open('/lyceum/storage/data.csv') as f:
        data = f.read()
    
    # Save results
    with open('/lyceum/storage/results.txt', 'w') as f:
        f.write('Processing complete')
    """]
    }
    ```
  </Tab>
</Tabs>

## Common Use Cases

<CardGroup cols={2}>
  <Card title="ML Training" icon="brain">
    ```python
    # PyTorch training job
    {
      "docker_image_ref": "pytorch/pytorch:latest",
      "docker_run_cmd": ["python", "train.py"],
      "execution_type": "gpu",
      "timeout": 7200,
      "docker_run_env": "CUDA_VISIBLE_DEVICES=0"
    }
    ```
  </Card>

  <Card title="Data Processing" icon="database">
    ```python
    # ETL pipeline
    {
      "docker_image_ref": "apache/spark:3.5.0",
      "docker_run_cmd": ["spark-submit", "etl.py"],
      "execution_type": "cpu",
      "docker_run_env": "SPARK_MASTER=local[*]"
    }
    ```
  </Card>

  <Card title="Web Scraping" icon="spider">
    ```python
    # Selenium automation
    {
      "docker_image_ref": "selenium/standalone-chrome",
      "docker_run_cmd": ["python", "scraper.py"],
      "execution_type": "cpu",
      "timeout": 1800
    }
    ```
  </Card>

  <Card title="API Services" icon="server">
    ```python
    # FastAPI service
    {
      "docker_image_ref": "tiangolo/uvicorn-gunicorn:python3.11",
      "docker_run_cmd": ["uvicorn", "main:app"],
      "execution_type": "cpu",
      "docker_run_env": "PORT=8000"
    }
    ```
  </Card>
</CardGroup>

## Monitoring Execution

### Real-time Output Streaming

<Tabs>
  <Tab title="Server-Sent Events" icon="broadcast">
    ```python
    import sseclient
    
    # Start execution and get callback URL
    response = requests.post(...)
    callback_url = response.json()["callback_url"]
    
    # Stream output
    messages = sseclient.SSEClient(callback_url)
    for msg in messages:
        if msg.data:
            print(msg.data)
    ```
  </Tab>

  <Tab title="Polling Status" icon="refresh">
    ```python
    import time
    
    execution_id = start_execution()
    
    while True:
        status = requests.get(
            f"{base_url}/execution/{execution_id}/status",
            headers={"Authorization": f"Bearer {token}"}
        ).json()
        
        print(f"Status: {status['state']}")
        
        if status['state'] in ['completed', 'failed']:
            break
        
        time.sleep(5)
    ```
  </Tab>
</Tabs>

## Best Practices

<AccordionGroup>
  <Accordion title="Image Optimization" icon="gauge-high">
    - Use slim base images (alpine, slim variants)
    - Multi-stage builds to reduce size
    - Cache dependencies in layers
    - Remove unnecessary files and packages
    
    ```dockerfile
    # Good: Multi-stage build
    FROM python:3.11 AS builder
    COPY requirements.txt .
    RUN pip install --user -r requirements.txt
    
    FROM python:3.11-slim
    COPY --from=builder /root/.local /root/.local
    COPY . .
    CMD ["python", "app.py"]
    ```
  </Accordion>

  <Accordion title="Security" icon="shield">
    - Never hardcode secrets in images
    - Use environment variables for credentials
    - Scan images for vulnerabilities
    - Use specific tags, not `latest`
    
    ```python
    # Good: Pass secrets via environment
    {
        "docker_run_env": f"API_KEY={os.environ['API_KEY']}"
    }
    
    # Bad: Hardcoded in image
    # RUN echo "API_KEY=secret" >> .env
    ```
  </Accordion>

  <Accordion title="Performance" icon="rocket">
    - Pre-pull large images to reduce startup time
    - Use appropriate resource allocation
    - Set reasonable timeouts
    - Implement health checks
    
    ```python
    # Optimize for quick starts
    {
        "docker_image_ref": "python:3.11-alpine",  # Small image
        "execution_type": "auto",  # Let platform optimize
        "timeout": 300  # Reasonable limit
    }
    ```
  </Accordion>
</AccordionGroup>

## Troubleshooting

<Warning>
  Common issues and solutions:
</Warning>

<AccordionGroup>
  <Accordion title="Image Pull Errors" icon="download">
    **Issue:** Container image not found or authentication failed
    
    **Solutions:**
    - Verify image name and tag exist
    - Check registry credentials
    - Ensure image is compatible with linux/amd64
    
    ```bash
    # Test locally first
    docker pull your-image:tag
    ```
  </Accordion>

  <Accordion title="Execution Timeouts" icon="clock">
    **Issue:** Execution exceeds timeout limit
    
    **Solutions:**
    - Increase timeout value
    - Optimize code performance
    - Use GPU for compute-intensive tasks
    - Break into smaller jobs
  </Accordion>

  <Accordion title="Out of Memory" icon="memory">
    **Issue:** Container runs out of memory
    
    **Solutions:**
    - Use larger machine type
    - Optimize memory usage
    - Process data in chunks
    - Clear unused variables
  </Accordion>
</AccordionGroup>

<Note>
  Need help? Contact support@lyceum.technology or check our [API Reference](/api-reference) for detailed specifications.
</Note>